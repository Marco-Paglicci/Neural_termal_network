# Ultralytics üöÄ AGPL-3.0 License - https://ultralytics.com/license
# Hyperparameters per training personalizzato su COCO con augmentation consigliata.
# Consigli:
# - Iniziare con 300 epoche; se non si verifica overfitting, si pu√≤ aumentare il numero di epoche.
# - Utilizzare --cos-lr per abilitare il cosine scheduler se si desidera una convergenza pi√π graduale.
# - Per le ultime epoche, valutare l'opzione --close-mosaic 10 per disabilitare il mosaic e stabilizzare l'allenamento.
# - Abilitare il mixed precision training (--amp) e, se disponibili, utilizzare multi-GPU (--device 0,1,...).
# - Questi iperparametri sono da usare come base: la regolazione fine potr√† essere effettuata tramite evoluzione degli iperparametri se necessario.

lr0: 0.01          # Learning rate iniziale (SGD=0.01, Adam=0.001)
lrf: 0.01          # Learning rate finale = lr0 * lrf (OneCycleLR)
momentum: 0.937    # Momentum per SGD / beta1 per Adam
weight_decay: 0.0005  # Weight decay dell'ottimizzatore
warmup_epochs: 3.0    # Numero di epoche di warmup
warmup_momentum: 0.8  # Momentum iniziale durante il warmup
warmup_bias_lr: 0.1   # Learning rate iniziale per i bias durante il warmup

box: 0.05          # Guadagno della loss per la box regression
cls: 0.5           # Guadagno della loss per le classi
cls_pw: 1.0        # Peso positivo per la BCELoss delle classi
obj: 1.0           # Guadagno della loss per gli oggetti (scale with pixels)
obj_pw: 1.0        # Peso positivo per la BCELoss degli oggetti
iou_t: 0.20        # Soglia IoU per il training
anchor_t: 4.0      # Soglia di moltiplicatore per gli anchor
fl_gamma: 0.0      # Gamma per la focal loss (default 0, alzare se necessario)

hsv_h: 0.015       # Augmentation HSV - Hue (frazione)
hsv_s: 0.7         # Augmentation HSV - Saturation (frazione)
hsv_v: 0.4         # Augmentation HSV - Value (frazione)
degrees: 3.0       # Rotazione dell'immagine (+/- gradi); aumentato da 0 per una leggera rotazione
translate: 0.1     # Traslazione dell'immagine (+/- frazione)
scale: 0.5         # Scala dell'immagine (+/- guadagno)
shear: 0.0         # Shear dell'immagine (+/- gradi)
perspective: 0.0   # Prospettiva dell'immagine (+/- frazione), solitamente molto bassa
flipud: 0.0        # Probabilit√† di flip verticale
fliplr: 0.5        # Probabilit√† di flip orizzontale

mosaic: 0.9        # Probabilit√† di applicare mosaic augmentation (leggermente ridotto da 1.0 per stabilit√†)
mixup: 0.1         # Probabilit√† di mixup augmentation (abilitato a 0.1 per un effetto moderato)
copy_paste: 0.0    # Probabilit√† di copy-paste per segmenti (solitamente lasciato a 0)

